## ===========================================
## Email RAG Bot - Frontend Values
## ===========================================
## Deploy command: helm install email-rag-frontend ./common-helmchart -f k8s-values-frontend.yaml

## Application identity
nameOverride: ""
fullnameOverride: "email-rag-frontend"
appLabels:
  app: email-rag
  component: frontend

## Container image
## Build command: docker build --platform linux/amd64 -t amiteshhsingh/email-rag-frontend:v1.0.8 ./frontend
image:
  repository: amiteshhsingh/email-rag-frontend
  tag: "v1.0.10"
  pullPolicy: IfNotPresent

# imagePullSecrets not needed for public Docker Hub images
# imagePullSecrets:
#   - name: regcred

## Deployment settings
replicaCount: 1
type: deployment
revisionHistoryLimit: 5

podAnnotations: {}

podLabels:
  app: email-rag
  component: frontend

annotations: {}

serviceAccount:
  create: false
  name: "email-rag-sa"
  annotations: {}

## Service Configuration
service:
  port: 80
  targetPort: 8080  # Nginx listens on 8080 (non-privileged port)
  protocol: TCP
  name: http
  annotations: {}

## Ingress Configuration
## Disabled for localhost/port-forwarding access
ingress:
  enabled: false
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/proxy-body-size: "5g"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "1200"  # 20 minutes for large file uploads
    nginx.ingress.kubernetes.io/proxy-send-timeout: "1200"  # 20 minutes
    nginx.ingress.kubernetes.io/proxy-connect-timeout: "120"  # 2 minutes
  hosts: []
  tls: []

## No persistence needed for frontend
persistence:
  enabled: false

## Autoscaling
autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 5
  targetCPUUtilizationPercentage: 70

## Pod Disruption Budget
pdb:
  minAvailable: 1

## Health checks
healthProbe:
  enabled: true
  path: /health
  port: 8080  # Nginx listens on 8080 (non-privileged port)
  livenessProbe:
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 3
    failureThreshold: 3
    successThreshold: 1
  readinessProbe:
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3
    successThreshold: 1
  startupProbe:
    initialDelaySeconds: 0
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 12
    successThreshold: 1

terminationGracePeriodSeconds: 30

## Environment Variables
env: []

envLocal: []

configMap:
  globalEnv: ""
  localEnv: {}

secrets: {}

configMapRef: []

secretRef: []

disable_configmap_local_env: false

## Container settings
args: []

## Security Context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1001
  runAsGroup: 1001
  fsGroup: 1001

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: false  # Nginx needs to write cache files

## Resources - Lightweight for static serving
resources:
  limits:
    cpu: 200m
    memory: 256Mi
  requests:
    cpu: 50m
    memory: 128Mi

## Node Selection
## Exclude GPU compute nodes
nodeSelector: {}

tolerations: []

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: kubernetes.io/hostname
              operator: NotIn
              values:
                - ihc-gpu-compute-03  # Exclude this GPU node

topologySpreadConstraints: []

## Network settings
hostNetwork: false
dnsPolicy: "ClusterFirst"
dnsConfig: {}

## Volumes
volumes: []

volumeMounts: []

initContainers: []

extraVolumes: []
extraVolumeMounts: []
